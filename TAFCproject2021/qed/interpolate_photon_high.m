%-------------------------------------------------------------------------------
%  set of functions to get new chi from eta and one random value; Marija;
%  There are 3 functions: eta> 3.3 (high), 0.01< eta < 3.3 (midrange) and eta < 0.01 (low);
%-------------------------------------------------------------------------------
function [chi] = interpolate_photon_high(eta, ratio)

p1_array = [ 0.000394589503051,     0.001758682038381,     0.002893874817675,     0.002104730355267,     -0.003634049745981,  ...
    -0.055937387233642,     -0.065886320279835,     -0.026147110013602,     -0.002940621306168,     -0.003894502232776,  ...
    -1.048747279807481,     -0.872789273537110,     -0.267400248879477,     -0.034452832734123,     -0.005414601503678,   ...
    1875.071802019952656,     300.495149184593060,     16.762405490950311,     0.373442696138872,     -0.001652051103320 ];
p2_array = [ -0.003971150489006,     -0.018055330405033,     -0.030513120343084,     -0.023030679161369,     0.042273956423612, ...
    0.329951816637183,     0.370401763115319,     0.126156506804666,     0.000407195758592,     0.042908607010348,   ...
    -0.354179154844088,     1.286949411802133,     0.739449801699535,     0.114599218464971,     0.049666212297222,   ...
    -16743.456812191390782,     -2690.227130010071960,     -151.629508314305980,     -3.554314465956319,     0.015338323224990 ];
p3_array = [ 0.015624480455891,     0.072569603108912,     0.126108887187262,     0.098804713961978,     -0.196613435156459,  ...
    -0.092237867707433,     0.054258855096189,     0.207495688575473,     0.146153041062157,     -0.189146562438188,  ...
    51.069523904044814,     29.535660711749539,     6.237888502630087,     0.654622916464811,     -0.174825363262565,   ...
    56887.183787550107809,     9184.043012321235437,     526.266972325473603,     13.271756641941396,     -0.054733202346443 ];
p4_array = [ -0.029199070329492,     -0.138548698396030,     -0.247451431218712,     -0.200886031023574,     1.438475028852042,   ...
    -2.638987961872001,     -3.620798753363849,     -2.020650203097647,     -0.611879714396155,     1.401780723462706,  ...
    -195.122632154715916,     -125.818836023634518,     -30.690761393156599,     -3.569844737674069,     1.287758082995097,  ...
    -89508.217916543173487,     -14572.859228520872421,     -856.519716321191368,     -23.819455788619784,     1.091395618969734 ];
p5_array = [ 0.048890836069625,     0.244727685140817,     0.454442708483244,     3.374002199572533,     -0.719404122634595,   ...
    6.615523470324536,     9.858398511739829,     6.018148533542798,     4.902198980643337,     -0.551056458816563,   ...
    117.323516878384979,     83.233549894578488,     24.205231838998493,     6.911554027078656,     -0.466984430164604,   ...
    55498.371969807310961,     9008.148552239785204,     526.826181903363249,     18.719241080848093,     -0.363030323053338 ];

lt_eta = log10(eta);
ltr = log10(ratio);

% Here we look for the right section of coefficients to use;

if ( ratio < 0.4 )
    n=1;
elseif ( ratio < 0.7 )
    n = 6;
elseif ( ratio < 0.9 )
    n = 11;
else
    n = 16;
end

pc1 = p1_array(n) * ( lt_eta^4.0 ) + p2_array(n) * ( lt_eta^3.0 ) + p3_array(n) * ( lt_eta^2.0 ) + p4_array(n) * lt_eta + p5_array(n);
pc2 = p1_array(n+1) * ( lt_eta^4.0 ) + p2_array(n+1) * ( lt_eta^3.0 ) + p3_array(n+1) * ( lt_eta^2.0 ) + p4_array(n+1) * lt_eta + p5_array(n+1);
pc3 = p1_array(n+2) * ( lt_eta^4.0 ) + p2_array(n+2) * ( lt_eta^3.0 ) + p3_array(n+2) * ( lt_eta^2.0 ) + p4_array(n+2) * lt_eta + p5_array(n+2);
pc4 = p1_array(n+3) * ( lt_eta^4.0 ) + p2_array(n+3) * ( lt_eta^3.0 ) + p3_array(n+3) * ( lt_eta^2.0 ) + p4_array(n+3) * lt_eta + p5_array(n+3);
pc5 = p1_array(n+4) * ( lt_eta^4.0 ) + p2_array(n+4) * ( lt_eta^3.0 ) + p3_array(n+4) * ( lt_eta^2.0 ) + p4_array(n+4) * lt_eta + p5_array(n+4);
pc = pc1 * ( ltr^4.0 ) + pc2 * ( ltr^3.0 ) + pc3 * ( ltr^2.0 ) + pc4 * ltr + pc5;
chi = 10^pc;